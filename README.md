# ğŸ“ˆ ETF Automated Reporting Pipeline  
### Automated Data Pipeline for ETF Performance, Risk, and Anomaly Detection (Python)

This project is an **end-to-end automated data analytics pipeline** that downloads ETF market data, cleans and structures it, computes financial KPIs, detects anomalies, generates visualizations, and exports a full reporting package.

The design follows a **modular, production-style architecture**, similar to reporting workflows used in financial institutions.

---

## ğŸš€ Features

### âœ” Automated data ingestion  
Downloads historical OHLC price data for multiple ETFs using `yfinance`.

### âœ” Data cleaning & transformation  
- Extracts structured close-price datasets  
- Computes *daily returns*  
- Computes *monthly returns* using `"ME"` month-end resampling  
- Saves cleaned datasets for downstream analysis

### âœ” Financial KPIs  
Calculated metrics include:
- Cumulative returns  
- Annualized volatility  
- Maximum drawdown  
- Year-to-date (YTD) return  
- Rolling 30-day volatility  

### âœ” Anomaly detection  
Using z-scores (`|z| > 3`), the pipeline identifies outlier return events and generates:
- A full anomaly dataset  
- A per-ETF anomaly summary with best/worst daily returns  

### âœ” Automated reporting  
Exports:
- `KPI_Summary.xlsx`  
- `Anomaly_Summary.xlsx`  
- All charts (PNG):
  - Cumulative returns  
  - Drawdown curves  
  - Rolling volatility  
  - Heatmaps  
  - Anomaly overlays  

---

## ğŸ“Š ETF Universe Analyzed

- **VCN.TO** â€” Vanguard FTSE Canada Index  
- **XIC.TO** â€” iShares Core S&P/TSX Composite Index  
- **BTCC-B.TO** â€” Purpose Bitcoin ETF  
- **ETHH-B.TO** â€” Purpose Ethereum ETF  

This selection mixes traditional equity ETFs with crypto ETFs, highlighting contrasting behaviors in volatility and drawdowns.

---

## ğŸ§± Project Structure

<pre><code>
main.py
config.yaml

src/
    data_ingestion.py
    data_cleaning.py
    kpi_calculations.py
    anomaly_detection.py
    reporting.py

data/
    raw/
    clean/

output/
    charts/
    final_report/
</code></pre>

  
---


## ğŸ› ï¸ How to Run the Pipeline

### 1. Install dependencies


pip install -r requirements.txt


### 2. Run the automated pipeline


python main.py


All final reports and charts will be generated in:



output/final_report/
output/charts/


---

## ğŸ“˜ Jupyter Notebook (Full Walkthrough)

For exploration, visual explanations, and step-by-step analysis:

ğŸ‘‰ **[View the Analysis Notebook](./automated_etf_reporting.ipynb)**  

---

## ğŸ“„ Downloadable Reports

- ğŸ“Š **[KPI Summary](output/final_report/KPI_Summary.xlsx)**  
- âš ï¸ **[Anomaly Summary](output/final_report/Anomaly_Summary.xlsx)**  

These files are automatically generated by the pipeline.

---

# ğŸ“ˆ Visual Outputs

Below are examples of the charts generated by the pipeline.

### ğŸ“ˆ Cumulative Returns  
![Cumulative Returns](output/charts/cumulative_returns.png)

---

### ğŸ“‰ Drawdown Curves  
![Drawdown Curves](output/charts/drawdown_curves.png)

---

### ğŸ“‰ Rolling 30-Day Volatility  
![Rolling Volatility](output/charts/rolling_volatility_30d.png)

---

### ğŸ” Anomaly Overlay  
![Anomaly Overlay](output/charts/anomaly_overlay_subplots.png)

---

### ğŸ—“ Monthly Returns Heatmaps  
![Monthly Heatmaps](output/charts/monthly_heatmaps.png)

---

## ğŸ“Š Power BI Dashboards

This project includes an automated Power BI reporting layer that updates directly from the Python pipeline outputs.
All reports are generated using parameterized connections, allowing Power BI Desktop to refresh the data daily without manual intervention.

Below are the dashboards included in the /Dashboard folder.

ğŸ“ Download the Interactive Power BI Report
ğŸ”— Pipeline_ETF_dashboard.pbix

This is the fullyâ€“interactive Power BI report used in the project.
You can open it in Power BI Desktop to explore all visuals, filters, and automated connections.

## ğŸ–¼ï¸ Dashboard Previews
### 1ï¸âƒ£ ETF Performance Overview Dashboard
ğŸ“¸ Preview
ğŸ”— Open full image:
View ETF_performance_overview.png

Description

This dashboard provides a high-level performance analysis of the selected ETFs, including:

Price Trend comparison

Year-to-Date (YTD) Return

Annualized Volatility

Maximum Drawdown

Monthly Returns Trend

Dynamic filters for ETF selection and Date range

All metrics update automatically according to the outputs generated by the Python pipeline.

### 2ï¸âƒ£ Risk Analysis Dashboard
ğŸ“¸ Preview
ğŸ”— Open full image:
View Risk_analysis.png

Description

This dashboard focuses on understanding the risk profile of each ETF:

Risk vs Return Scatter Plot (Volatility vs YTD Return)

Daily Returns Trend

Distribution of Daily Returns (Histogram)

Monthly Returns Heatmap

All visuals dynamically adapt to selected ETFs and dates

This view highlights volatility behavior, return dispersion, and monthly performance patterns.

### ğŸ§ª ETF Coverage Clarification

Originally, the automated Python pipeline was configured to analyze four ETFs as a minimal working example.
However, the Power BI reporting layer is fully flexible:

âœ”ï¸ The pipeline.yml allows you to run the pipeline with any list of tickers
âœ”ï¸ The Power BI dashboards visualize any ETFs included in the latest pipeline run

This means the datasets powering the dashboards may include different ETFs depending on your most recent pipeline execution.

The system is fully dynamic and supports:

Adding or removing ETFs

Switching to different markets

Running ad-hoc analyses over custom tickers

---
## ğŸ”— End-to-End Architecture Summary

Python pipeline extracts, cleans, computes KPIs, and exports updated CSV/XLSX files

Outputs follow a structured folder format (clean/ and final_report/)

Power BI connects using a BaseFolderPath parameter, ensuring automated refresh

Dashboards always reflect the most recent market data

---

## ğŸ” Skills Demonstrated


- Python (Pandas, NumPy, Matplotlib, Seaborn, SciPy)  
- Financial analytics: volatility, drawdown, returns  
- Anomaly detection and risk analysis  
- Data engineering & pipeline automation  
- Modular software design (multi-file architecture)  
- YAML configuration  
- Reporting automation  
- Data visualization best practices  

---

## ğŸ‘©ğŸ»â€ğŸ’» Author

**Mayerlin DÃ­az**  
Data Analyst â€¢ Python â€¢ Financial Analytics  

---

